angular.module("ngTableResize",[]),angular.module("ngTableResize").directive("resizeable",["resizeStorage","$injector",function(t,e){function n(t,e,n){z=e,C=t.container?$(t.container):$(z).parent(),$(z).addClass("resize"),s(z,n,t),o(z,n,t),i(z,n,t)}function o(t,e,n){void 0!==n.bind&&(n.bind={update:function(){r(t),s(t,e,n)}})}function i(t,e,n){n.$on("table-resize-reset",function(){r(t),s(t,e,n)}),n.$watch(function(){return n.mode},function(){r(t),s(t,e,n)})}function r(t){T=!0,u(t)}function u(t){$(t).find("th").find(".handle").remove()}function s(e,n,o){b=$(e).find("th"),v=o.mode,y=!angular.isDefined(o.saveTableSizes)||o.saveTableSizes;var i=f(o,n);i&&(R=new i(e,b,C),y&&(S=t.loadTableSizes(e,o.mode)),g=R.handles(b),w=R.ctrlColumns,R.setup(),a(S),g.each(function(t,n){c(e,n,o)}))}function a(t){t&&($(z).width("auto"),w.each(function(e,n){var o=$(n).attr("id"),i=t[o];$(n).css({width:i})}),R.onTableReady())}function c(t,e,n){var o=$("<div>",{"class":"handle"});$(e).prepend(o);var i=R.handleMiddleware(o,e);l(t,o,i,n)}function l(t,e,n,o){$(e).mousedown(function(t){T&&(R.onFirstDrag(n,e),R.onTableReady(),T=!1);var i={};R.intervene&&(i=R.intervene.selector(n),i.column=i,i.orgWidth=$(i).width()),t.preventDefault(),$(e).addClass("active"),$("body").addClass("table-resize");var r=t.clientX,u=$(n).width();$(window).mousemove(d(n,r,u,i)),$(window).one("mouseup",p(e,o))})}function d(t,e,n,o){return function(i){var r=i.clientX,u=r-e,s=R.calculate(n,u);if(!(s<h(t)||R.restrict(s))){if(R.intervene){var a=R.intervene.calculator(o.orgWidth,u);if(a<h(o.column))return;if(R.intervene.restrict(a))return;$(o.column).width(a)}$(t).width(s)}}}function h(t){return parseInt($(t).css("min-width"))||0}function f(t,n){try{var o=n.mode?t.mode:"BasicResizer",i=e.get(o);return i}catch(r){return console.error("The resizer "+t.mode+" was not found"),null}}function p(t,e){return function(){$(t).removeClass("active"),$(window).unbind("mousemove"),$("body").removeClass("table-resize");var n=R.onEndDrag();e.$emit("table-resize-end",n),m()}}function m(){y&&(S||(S={}),$(b).each(function(t,e){var n=$(e).attr("id");n&&(S[n]=R.saveAttr(e))}),t.saveTableSizes(z,v,S))}var v,y,b=null,w=null,g=null,z=null,C=null,R=null,T=!0,S=null;return{restrict:"A",link:n,scope:{mode:"=",saveTableSizes:"=?",bind:"=",container:"@"}}}]),angular.module("ngTableResize").service("resizeStorage",["$window",function(t){function e(t,e){var o=t.attr("id");return o?n+"."+t.attr("id")+"."+e:void console.error("Table has no id",t)}var n="ngColumnResize";this.loadTableSizes=function(n,o){var i=e(n,o),r=t.localStorage.getItem(i);return JSON.parse(r)},this.saveTableSizes=function(n,o,i){var r=e(n,o);if(r){var u=JSON.stringify(i);t.localStorage.setItem(r,u)}}}]),angular.module("ngTableResize").factory("ResizerModel",[function(){function t(t,e,n){this.table=t,this.columns=e,this.container=n,this.handleColumns=this.handles(),this.ctrlColumns=this.ctrlColumns()}return t.prototype.setup=function(){$(this.container).css({overflowX:"hidden"})},t.prototype.onTableReady=function(){$(this.table).outerWidth("100%")},t.prototype.handles=function(){return this.columns},t.prototype.ctrlColumns=function(){return this.handleColumns},t.prototype.onFirstDrag=function(){$(this.ctrlColumns).each(function(t,e){$(e).width($(e).width())})},t.prototype.handleMiddleware=function(t,e){return e},t.prototype.restrict=function(t){return!1},t.prototype.calculate=function(t,e){return t+e},t.prototype.onEndDrag=function(){},t.prototype.saveAttr=function(t){return $(t).outerWidth()},t}]),angular.module("ngTableResize").factory("BasicResizer",["ResizerModel",function(t){function e(e,r,u){t.call(this,e,r,u),this.ctrlColumns=this.columns,this.intervene={selector:n,calculator:o,restrict:i}}function n(t){return $(t).next()}function o(t,e){return t-e}function i(t){return t<25}return e.prototype=Object.create(t.prototype),e.prototype.setup=function(){$(this.container).css({overflowX:"hidden"})},e.prototype.handles=function(){return $(this.columns).not(":last")},e.prototype.onFirstDrag=function(){$(this.columns).each(function(t,e){$(e).width($(e).width())})},e.prototype.onEndDrag=function(){var t=$(this.table).outerWidth(),e=0,n=[];return $(this.columns).each(function(o,i){var r=$(i).outerWidth(),u=r/t*100+"%";e+=r/t*100,n.push(u),$(i).css({width:u})}),n},e.prototype.saveAttr=function(t){return $(t)[0].style.width},e}]),angular.module("ngTableResize").factory("FixedResizer",["ResizerModel",function(t){function e(e,n,o){t.call(this,e,n,o),this.fixedColumn=$(e).find("th").first(),this.bound=!1}return e.prototype=Object.create(t.prototype),e.prototype.setup=function(){$(this.container).css({overflowX:"hidden"}),$(this.columns).first().css({width:"auto"})},e.prototype.handles=function(){return $(this.columns).not(":last")},e.prototype.ctrlColumns=function(){return $(this.columns).not(":first")},e.prototype.onFirstDrag=function(){$(this.ctrlColumns).each(function(t,e){$(e).width($(e).width())})},e.prototype.handleMiddleware=function(t,e){return $(e).next()},e.prototype.restrict=function(t){return this.bound?!(t<this.bound)||($(this.fixedColumn).width("auto"),this.bound=!1,!1):t<this.minWidth||($(this.fixedColumn).width()<=this.minWidth?(this.bound=t,$(this.fixedColumn).width(this.minWidth),!0):void 0)},e.prototype.calculate=function(t,e){return t-e},e}]),angular.module("ngTableResize").factory("OverflowResizer",["ResizerModel",function(t){function e(e,n,o){t.call(this,e,n,o)}return e.prototype=Object.create(t.prototype),e.prototype.setup=function(){$(this.container).css({overflow:"auto"})},e.prototype.onTableReady=function(){$(this.table).width(1)},e}]);